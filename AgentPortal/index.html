<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Dashboard </title>
    <link rel="stylesheet" href="dashboard.css">
</head>

<body>
    <section>

        <h1>SkyNet Portal</h1>

        <ul>
            <button class="btnExecuteCommand" data-bind="click: ShowExecuteAgentForm.bind(this, true)" >Execute Command</button>
            <button class="buttonFloatRight" data-bind='enable: agents().length > 0'>Remove Agent</button>
            <button class="buttonFloatRight"  data-bind="click: ShowUpdateAgentForm.bind(this, true)">Edit Agent</button>
            <button class="buttonFloatRight" data-bind="click: ShowAddAgentForm.bind(this, true)">Add Agent</button>
        </ul>

        <div data-bind="visible: agents().length > 0"></div>
        <div data-bind="foreach: agents" class="gridwrapper">
            <div data-bind="text: $data.name" class="grid"></div>
        </div>
        </div>
    </section>

    <!-- Add Form -->

    <form data-bind="submit: save" class="newagentform">
        <fieldset class="agent-action" data-bind="visible: ShowAddAgent">
            <label>
                Agent Name :
                <input type="text" name="name">
            </label>
            <br>
            <br>
            <label>
                IP Address :
                <input type="text" name="ipAddress">
            </label>
            <br>
            <br>
            <label>
                Port :
                <input type="text" name="port">
            </label>
            <br>
            <br>
            <input type="button" name="cancel" value="Cancel" data-bind="click: ShowAddAgentForm.bind(this,false)">
            <input type="submit" name="submit" value="Save">
        </fieldset>
    </form>

    <!-- Update -->
    <form>
        <fieldset class="agent-action" data-bind="visible: ShowUpdateAgent">
            <label>
                Agent Name :
                <input type="text" name="name">
            </label>
            <br>
            <br>
            <label>
                IP Address :
                <input type="text" name="ipAddress">
            </label>
            <br>
            <br>
            <label>
                Port :
                <input type="text" name="port">
            </label>
            <br>
            <br>
            <input type="button" name="cancel" value="Cancel" data-bind="click: ShowUpdateAgentForm.bind(this,false)">
            <input type="submit" name="submit" value="Update">
        </fieldset>
    </form>

    <!-- Execute form -->
    <form >
        <fieldset data-bind="visible: showExecuteAgent">
        <label>Agent Name :
            <select>
                <!-- Needs to be static -->
                <option value="test">Agent 1</option>
                <option value="test">Agent 2</option>
                <option value="test">Agent 3</option>
                <option value="test">Agent 4</option>
            </select>
        </label>
        <br>
        <br>
        <label>Command :
            <select>
                <option value="test">Get IP</option>
                <option value="test">Get OS</option>
                <option value="test">Get hostname</option>
                <option value="test">Get Fully qualified hostname</option>
                <option value="test">Execute powershell script</option>
            </select>
        </label>
        <br>
        <br>
        <label>Script :
            <textarea rows="4" cols="50"></textarea>
        </label>
        <br>
        <br>
        <input type="button" value="Cancel" data-bind="click: ShowExecuteAgentForm.bind(this,false")>
        <input type="submit" value="Execute">
    </form>
</fieldset>

    <script type="text/javascript" src="lib/knockout-3.4.2.js"></script>
    <script type="text/javascript" src="src/agentService.js"></script>
    <script type="text/javascript" src="src/serviceStorage.js"></script>
    <script type="text/javascript" src="src/agent.js"></script>
    <script type="text/javascript" src="src/addViewModel.js"></script>

    <script>
        let persistence = new storageService();
        let service = new agentService(persistence);
        let viewModel = new addViewModel(service);
        ko.applyBindings(viewModel);
    </script>

</body>

</html>